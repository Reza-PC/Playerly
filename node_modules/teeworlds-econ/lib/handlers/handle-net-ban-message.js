var debug, handleNetBanMessage;

debug = require('../utils').debug;

handleNetBanMessage = function(econ, message) {
  var matches;
  if (matches = /^\[net_ban\]: banned '([^']+)' for ([0-9]+) minutes? \((.+?)\)$/.exec(message)) {
    debug.events('%s:%s econ %s event', econ.server.host, econ.server.port, 'netban');
    econ.emit('netban', {
      ip: matches[1],
      reason: matches[3],
      minutes: matches[2],
      life: false
    });
  }
  if (matches = /^\[net_ban\]: '([^']+)' banned for life \((.+?)\)$/.exec(message)) {
    debug.events('%s:%s econ %s event', econ.server.host, econ.server.port, 'netban');
    return econ.emit('netban', {
      ip: matches[1],
      reason: matches[2],
      minutes: null,
      life: true
    });
  }
};

module.exports = handleNetBanMessage;
